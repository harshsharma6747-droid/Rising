<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gallery | Rising Star Academy School</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="icon" href="assets/images/logo.png" type="image/png">
</head>
<body>

    <header class="header">
        <nav class="navbar container">
            <a href="index.html" class="nav-logo">
                <img src="assets/images/logo.png" alt="Rising Star Academy Logo">
            </a>

            <ul class="nav-menu">
                <li class="nav-item"><a href="index.html" class="nav-link">Home</a></li>
                <li class="nav-item"><a href="about.html" class="nav-link">About Us</a></li>
                <li class="nav-item"><a href="academics.html" class="nav-link">Academics</a></li>
                <li class="nav-item"><a href="admissions.html" class="nav-link">Admissions</a></li>
                <li class="nav-item"><a href="student-life.html" class="nav-link">Student Life</a></li>
                <li class="nav-item"><a href="gallery.html" class="nav-link active">Gallery</a></li>
                <li class="nav-item"><a href="contact.html" class="nav-link">Contact</a></li>
            </ul>

            <div class="nav-actions">
                <a href="portal.html" class="btn btn-primary">Portal</a>
                <span class="dark-mode-toggle" id="dark-mode-toggle">
                    <i class="fas fa-moon"></i>
                </span>
                <div class="nav-toggle" id="nav-toggle">
                    <i class="fas fa-bars"></i>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <section class="section" style="padding-top: 100px;">
            <div class="container">
                <h1 class="section-title fade-in">School Gallery</h1>
                <p class="fade-in" style="text-align: center; max-width: 600px; margin: 0 auto 40px;">A glimpse into the vibrant life, creative activities, and happy moments at Rising Star Academy.</p>
                
                <div class="gallery-grid" id="gallery-grid">
                    <p id="loading-gallery" style="text-align: center; width: 100%;">Loading gallery images...</p>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <img src="assets/images/logo.png" alt="Rising Star Logo" style="max-width: 150px; background: #fff; border-radius: 8px; padding: 10px;">
                    <p>Rising Star Academy School<br>Kuraj, Rajsamand</p>
                </div>
                <div class="footer-col">
                    <h4>Quick Links</h4>
                    <a href="about.html">About Us</a>
                    <a href="admissions.html">Admissions</a>
                    <a href="academics.html">Academics</a>
                    <a href="contact.html">Contact</a>
                </div>
                <div class="footer-col">
                    <h4>Contact Us</h4>
                    <p><i class="fas fa-phone"></i> +91 99823 62434</p>
                    <p><i class="fas fa-envelope"></i> rsakuraj@gmail.com</p>
                    <p><i class="fas fa-map-marker-alt"></i> Kuraj, Rajsamand</p>
                </div>
                <div class="footer-col">
                    <h4>Follow Us</h4>
                    <div class="footer-socials">
                        <a href="https://www.facebook.com/profile.php?id=100057679950927" target="_blank"><i class="fab fa-facebook"></i></a>
                        <a href="https://www.instagram.com/ameta.lalit?igsh=Z2oxczB3bGtycDl0" target="_blank"><i class="fab fa-instagram"></i></a>
                        <a href="https://youtube.com/@lalitameta2901?si=oVvpmZ9fWWEQeLaa" target="_blank"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>Â© 2025 Rising Star Academy School. All Rights Reserved.</p>
            </div>
        </div>
    </footer>

    <script type="module" src="assets/js/firebase.js"></script>
    <script src="assets/js/main.js"></script>

    <script type="module">
        import { db, collection, getDocs, query, orderBy } from './assets/js/firebase.js';

        const galleryGrid = document.getElementById('gallery-grid');
        const loadingMsg = document.getElementById('loading-gallery');

        async function fetchGalleryImages() {
            try {
                const q = query(collection(db, "gallery"), orderBy("uploadedAt", "desc"));
                const querySnapshot = await getDocs(q);

                if (querySnapshot.empty) {
                    loadingMsg.textContent = 'No images found in the gallery.';
                    return;
                }

                galleryGrid.innerHTML = ''; // Clear loading message
                querySnapshot.forEach((doc) => {
                    const image = doc.data();
                    const item = document.createElement('a');
                    item.href = image.imageURL; // Or a lightbox
                    item.classList.add('gallery-item', 'fade-in');
                    item.innerHTML = `<img src="${image.imageURL}" alt="${image.caption || 'School-Image'}">`;
                    galleryGrid.appendChild(item);
                });
                
                // Re-trigger fade-in observer for dynamically added items
                const newFadeElements = document.querySelectorAll('.fade-in');
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('visible');
                            observer.unobserve(entry.target);
                        }
                    });
                }, { threshold: 0.1 });
                newFadeElements.forEach(el => observer.observe(el));


            } catch (error) {
                console.error("Error fetching gallery: ", error);
                loadingMsg.textContent = 'Could not load gallery. Please try again later.';
            }
        }

        fetchGalleryImages();
    </script>
</body>
</html>
